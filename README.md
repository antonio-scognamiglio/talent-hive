# TalentHive ğŸ

**Modern Applicant Tracking System (ATS)** - Full-stack monorepo with React 19, Express, Prisma, PostgreSQL, and MinIO.

> Single-tenant CRM-style recruitment platform with Kanban workflow, RBAC, CV upload, and shared TypeScript types architecture.

---

## ğŸ“‹ Table of Contents

- [Tech Stack](#-tech-stack)
- [Quick Start](#-quick-start)
- [Project Structure](#-project-structure)
- [User Roles & RBAC](#-user-roles--rbac)
- [API Overview](#-api-overview)
- [Development](#-development)
- [Type System](#-type-system)

---

## ğŸ› ï¸ Tech Stack

### Frontend

- **React 19** + **TypeScript 5.9**
- **Vite 7** (build tool)
- **TailwindCSS 4** (styling)
- **TanStack Query v5** (server state management)
- **React Router v7** (routing with RBAC)
- **Shadcn UI** (component library)
- **Axios** (HTTP client)

### Backend

- **Node.js** + **Express** (REST API)
- **Prisma ORM 5.10** (database with type generation)
- **PostgreSQL** (database)
- **MinIO** (object storage for CVs)
- **JWT** (authentication with httpOnly cookies)
- **Multer** (file upload middleware)
- **Zod** (validation)

### Shared

- **TypeScript Interfaces** (Prisma â†’ shared types)
- **DTOs** (Request/Response types)
- **Prisma Query Types** (Frontend query building)

### Infrastructure

- **Docker Compose** (PostgreSQL + MinIO)
- **Bun** (package manager & runtime)

---

## ğŸš€ Quick Start

### Prerequisites

- **Node.js 18+** (required)
- **Package Manager**: [Bun](https://bun.sh) (recommended), npm, yarn, or pnpm
- [Docker Desktop](https://www.docker.com/products/docker-desktop) running

### 1. Clone and Install

```bash
git clone <repo-url>
cd talent-hive
bun install
```

### 2. Setup Environment Variables

```bash
# Backend
cd backend
cp .env.example .env
# Edit .env and update DATABASE_URL if needed

# Frontend
cd ../frontend
cp .env.example .env
# Default VITE_API_URL should work for local development
```

### 3. Start Docker Services

```bash
# Start PostgreSQL + MinIO
docker-compose up -d

# Verify containers are running
docker ps
# Should see: talent-hive-postgres, talent-hive-minio
```

### 4. Setup Database

```bash
cd backend

# Generate Prisma types (â†’ shared/types/entities/generated/)
bunx prisma generate

# Run migrations
bun run db:push

# Seed database with test data
bun run db:seed
```

**Seed creates**:

- 1 Admin: `admin@talenthive.com` / `Admin123!`
- 2 Recruiters: `sara@talenthive.com` / `Sara123!`, `marco@talenthive.com` / `Marco123!`
- 3 Candidates: `mario@example.com` / `Mario123!`, etc.
- 5 Jobs (PUBLISHED, DRAFT, ARCHIVED)
- 6 Applications (various workflow states)

### 5. Start Backend

```bash
# From backend directory
bun run dev

# Server starts at http://localhost:3000
# Health check: http://localhost:3000/health
```

### 6. Start Frontend

```bash
cd frontend
bun run dev

# App starts at http://localhost:5173
```

---

## ğŸ“ Project Structure

```
talent-hive/
â”œâ”€â”€ backend/                    # Express API
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”œâ”€â”€ schema.prisma      # Database schema + type generator config
â”‚   â”‚   â”œâ”€â”€ seed.ts            # Test data
â”‚   â”‚   â””â”€â”€ migrations/        # DB migrations
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/            # API endpoints
â”‚   â”‚   â”œâ”€â”€ services/          # Business logic (RBAC enforcement)
â”‚   â”‚   â”œâ”€â”€ middlewares/       # Auth, RBAC
â”‚   â”‚   â”œâ”€â”€ types/             # Backend-only types (pagination, etc.)
â”‚   â”‚   â””â”€â”€ utils/             # Helpers
â”‚   â””â”€â”€ test-api.http          # API tests (REST Client)
â”‚
â”œâ”€â”€ frontend/                   # React app
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ features/          # Feature-based architecture
â”‚       â”‚   â”œâ”€â”€ auth/          # Authentication
â”‚       â”‚   â”œâ”€â”€ jobs/          # Jobs feature (in progress)
â”‚       â”‚   â”œâ”€â”€ pagination/    # usePaginationForGen hook
â”‚       â”‚   â””â”€â”€ shared/        # Shared components, services, types
â”‚       â””â”€â”€ types/             # Frontend-only types
â”‚
â”œâ”€â”€ shared/                     # Shared between FE/BE
â”‚   â””â”€â”€ types/                 # TypeScript types (single source of truth)
â”‚       â”œâ”€â”€ dto/               # Data Transfer Objects (API contracts)
â”‚       â”œâ”€â”€ entities/          # Prisma-generated interfaces
â”‚       â”‚   â””â”€â”€ generated/     # Auto-generated by prisma-generator
â”‚       â””â”€â”€ responses/         # API response types
â”‚
â”œâ”€â”€ docker-compose.yml         # PostgreSQL + MinIO
â””â”€â”€ README.md
```

---

## ğŸ‘¥ User Roles & RBAC

### ğŸ”‘ ADMIN

- **Full access** to all resources
- Can create/manage RECRUITER accounts
- Bypasses ownership checks
- **Job visibility**: ALL jobs (any status)
- **Application visibility**: ALL applications

### ğŸ•µï¸ RECRUITER

- **Job visibility**:
  - âœ… All **PUBLISHED** jobs (marketplace) - including from other recruiters
  - âœ… Own jobs with **any status** (DRAFT, PUBLISHED, ARCHIVED)
  - âŒ DRAFT/ARCHIVED jobs from other recruiters
- **Job management**: Can only create/edit/delete **own jobs**
- **Application management**: Can only manage applications for **own jobs**
- Manage Kanban workflow: NEW â†’ SCREENING â†’ INTERVIEW â†’ OFFER
- Hire/Reject candidates (for own jobs only)

### ğŸ‘¨â€ğŸ’¼ CANDIDATE

- **Job visibility**: Only **PUBLISHED** jobs
- Apply with CV upload (PDF, max 5MB)
- Track own application status
- Cannot see other candidates' applications

**RBAC Implementation**: All data filtering happens in **backend services** (not routes). Frontend sends Prisma queries, backend sanitizes based on user role.

---

## ğŸ”Œ API Overview

### Auth

- `POST /api/auth/login` - Login (sets httpOnly cookie)
- `POST /api/auth/register` - Register (CANDIDATE self-register, role forced)
- `POST /api/auth/logout` - Logout
- `GET /api/auth/me` - Get current user

### Jobs

- `POST /api/jobs/list` - **List jobs with Prisma query** (RBAC filtered)
  - Body: `{ skip?, take?, where?, orderBy?, include? }`
  - Returns: `{ data: Job[], count: number, query: {...} }`
- `GET /api/jobs/:id` - Get job by ID
- `POST /api/jobs` - Create job (RECRUITER/ADMIN)
- `PATCH /api/jobs/:id` - Update job (owner or ADMIN)
- `DELETE /api/jobs/:id` - Archive job (soft delete)

### Applications

- `POST /api/applications/list` - List applications (RBAC)
- `GET /api/applications/my` - Candidate's own apps
- `GET /api/applications/:id` - Get by ID
- `POST /api/applications` - Apply (with CV upload)
- `PATCH /api/applications/:id/workflow` - Move Kanban
- `POST /api/applications/:id/hire` - Hire candidate
- `POST /api/applications/:id/reject` - Reject candidate
- `PATCH /api/applications/:id/notes` - Add notes/score

**All endpoints require authentication** (JWT httpOnly cookie).

**Pattern**: `/list` endpoints accept **Prisma query options** for flexible filtering/sorting.

---

## ğŸ’» Development

### Database Commands

```bash
cd backend

# Generate TypeScript types (â†’ shared/types/)
bunx prisma generate

# Create new migration
bunx prisma migrate dev --name migration_name

# Push schema without migration (dev only)
bun run db:push

# Reset database (WARNING: deletes all data)
bunx prisma migrate reset

# Re-seed with test data
bun run db:seed

# Open Prisma Studio (database GUI)
bun run db:studio
```

### Build Commands

```bash
# Backend
cd backend
bun run build        # TypeScript compilation

# Frontend
cd frontend
bun run build        # Vite production build
bun run preview      # Preview production build
```

### MinIO Access

- **Console**: http://localhost:9001
- **Username**: `minioadmin`
- **Password**: `minioadmin`
- **Bucket**: `talenthive-cvs`

### Docker Commands

```bash
# Start services
docker-compose up -d

# Stop services
docker-compose down

# View logs
docker-compose logs -f postgres
docker-compose logs -f minio

# Rebuild containers
docker-compose up -d --build
```

---

## ğŸ§ª Testing

### Manual API Testing

Use `backend/test-api.http` with [REST Client](https://marketplace.visualstudio.com/items?itemName=humao.rest-client) extension:

1. Open `test-api.http` in VS Code
2. Click "Send Request" above each endpoint
3. Cookies are auto-managed between requests

### Example Test Flow

```http
### 1. Login as Recruiter
POST http://localhost:3000/api/auth/login
Content-Type: application/json

{
  "email": "sara@talenthive.com",
  "password": "Sara123!"
}

### 2. List Sara's jobs (PUBLISHED + own)
POST http://localhost:3000/api/jobs/list
Content-Type: application/json

{
  "skip": 0,
  "take": 10,
  "orderBy": { "createdAt": "desc" }
}

### 3. Filter only Sara's DRAFT jobs
POST http://localhost:3000/api/jobs/list
Content-Type: application/json

{
  "where": { "status": "DRAFT" },
  "skip": 0,
  "take": 10
}
```

---

## ğŸ—ï¸ Type System

### Architecture Overview

```
Prisma Schema (schema.prisma)
      â†“
  [prisma generate]
      â†“
shared/types/entities/generated/interfaces.ts  â† Auto-generated
      â†“
Backend imports from @prisma/client (runtime + types)
Frontend imports from @shared/types (types only)
```

### Type Locations

**Generated Types** (never modify):

- `shared/types/entities/generated/interfaces.ts` - Prisma models as TS interfaces

**Shared Types** (manually defined):

- `shared/types/dto/` - Request DTOs (`LoginDto`, `CreateJobDto`, `ListJobsDto`)
- `shared/types/responses/` - Response types (`AuthResponse`)
- `shared/types/entities/` - Derived types (`UserWithoutPassword`, `UserProfile`)

**Backend-only Types**:

- `backend/src/types/pagination.types.ts` - `PaginatedResponse<T>` (backend version)

**Frontend-only Types**:

- `frontend/src/types/pagination.types.ts` - `PaginatedResponse<T>` (frontend version)
- `frontend/src/features/shared/types/prismaQuery.types.ts` - `PrismaQueryOptions<T>` helpers

### Type Generation Workflow

```bash
# 1. Update Prisma schema
cd backend
vim prisma/schema.prisma

# 2. Generate types (outputs to shared/types/)
bunx prisma generate

# 3. Backend and Frontend now have updated types
# Backend: @prisma/client + @shared/types
# Frontend: @shared/types only
```

### Design Decisions

- **Backend**: Uses `@prisma/client` directly for full Prisma capabilities
- **Frontend**: Uses pure TS interfaces from `@shared/types` (no Prisma runtime)
- **DTOs**: Follow Simple DTO pattern - simple with `[key: string]: any` for Prisma queries
- **Separation**: Backend/Frontend pagination types differ in `query` field typing

---

## ğŸ“Š Database Schema

### Key Models

**User**

- `role`: ADMIN | RECRUITER | CANDIDATE (enum)
- `password`: Hashed with bcrypt
- Fields: email (unique), firstName, lastName

**Job**

- `status`: DRAFT | PUBLISHED | ARCHIVED (enum)
- `createdBy`: Relation to User (owner)
- Fields: title, description, location, salaryRange

**Application**

- `workflowStatus`: NEW | SCREENING | INTERVIEW | OFFER | DONE (enum)
- `finalDecision`: HIRED | REJECTED | null
- `cvUrl`: Path to CV in MinIO
- Unique constraint: `[jobId, userId]` (one application per job per user)

---

## ğŸš§ Roadmap

**Backend** âœ…

- [x] REST API (Auth, Jobs, Applications)
- [x] Database schema with RBAC
- [x] CV upload to MinIO
- [x] Type generation to shared folder
- [x] Security: RBAC enforcement in services
- [x] Powergiob pattern for query DTOs

**Frontend** ğŸš§

- [x] Feature-based architecture
- [x] Authentication flow with RBAC routing
- [x] Sidebar layout with responsive design
- [x] Type system integration
- [x] Service layer (`jobs.service.ts`)
- [x] `usePaginationForGen` hook
- [x] `useJobs` hook
- [x] Jobs listing page (CANDIDATE view)
- [x] Job detail page (CANDIDATE view)
- [ ] Application flow
- [ ] Kanban board component (RECRUITER)
- [ ] User Management (Admin - TBD)

**Future / Ideas**

- [ ] Email notifications (Maybe)
- [x] Advanced search with filters (In Progress)
- [ ] Analytics dashboard
- [ ] Export to CSV/PDF
- [ ] Multi-language support

---

## ğŸ“ License

MIT

---

## ğŸ¤ Contributing

This is a portfolio/learning project. Feedback welcome!

---
